<div class="page-container">
  <div class="header">
    <span class="title">Sprint backlog</span>
    <div>
      <div class="resolving-stories-error">
        {{this.errorMessage}}
      </div>
      <button
        *ngIf="!this.resolvingStories"
        mat-raised-button
        color="accent"
        class="dialog-button"
        (click)="viewSprints()">
        Pregled sprintov
      </button>
      <button
        mat-raised-button
        color="primary"
        class="dialog-button"
        *ngIf="(this.isAdmin || this.userRoles.includes('Product Owner')) && activeSprint!=null && !this.resolvingStories"
        [ngStyle]="{marginLeft: '5px'}"
        (click)="this.resolvingStories = true">
        Sprejmi / Zavrni zgodbe
      </button>
      <button
        *ngIf="this.resolvingStories"
        mat-raised-button
        color="accent"
        class="dialog-button"
        [disabled]="this.resolvingStoriesSendingData"
        (click)="resolveStories()"
        >
        Potrdi
      </button>
      <button
        *ngIf="this.resolvingStories"
        mat-raised-button
        color="secondary"
        class="dialog-button"
        [disabled]="this.resolvingStoriesSendingData"
        [ngStyle]="{marginLeft: '5px'}"
        (click)="this.resolvingStories = false; this.errorMessage='' "
        >
        Prekliƒçi
      </button>
    </div>
  </div>


  <div id="info-section">
    <div *ngIf="activeSprint!=null; else noActiveSprint">Aktivni sprint: {{activeSprint.start_date | sprintDate}} - {{activeSprint.end_date | sprintDate}}</div>
    <ng-template #noActiveSprint>Trenutno ni aktivnega sprinta.</ng-template>
  </div>

  <div>
    <div *ngIf="activeSprint!=null && stories.length === 0">
      V aktivnem sprintu trenutno ni zgodb.
    </div>

    <div class="stories-container">
      <div class = "resolve-stories-header">
        <div class="resolve-stories-header-title" *ngIf="this.resolvingStories">
          Sprejmi
        </div>
        <div class="resolve-stories-header-title" *ngIf="this.resolvingStories">
          Zavrni
        </div>
      </div>
      <div *ngFor="let story of stories">
        <app-sprint-story
          [resolvingStories]="this.resolvingStories"
          [story] = "story"
          [tasks] = "story.tasks"
          [userRoles] = "this.isAdmin ? ['Admin'] : this.userRoles"
          (editButtonClick)="addTask(story)"
          (acceptStory) = "acceptStory($event)"
          (rejectStory) = "rejectStory($event)"
          (rejectionComment) = "rejectionComment($event)"
        ></app-sprint-story>
      </div>
    </div>

  </div>

</div>
